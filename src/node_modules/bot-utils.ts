import logger from "log";
import tokens from "get-tokens";
import { CommandoMessage } from 'discord.js-commando';

export async function unpartial<T>(target: T & { partial: boolean, fetch: () => Promise<T> }) {
	if (!target.partial)
		return true;

	try {
		await target.fetch();
		
		return true;
	} catch (error) {
		logger.error("Unable to unpartial:", error);
		return false;
	}
}

export function isModerator(message: CommandoMessage) {
	var role = message.guild.roles.cache.get(tokens.roleIDs.moderator);
	if (!role)
		return false;

	return message.member.roles.highest.comparePositionTo(role) >= 0;
}